services:
  # Dienst 1: Der NonPlusUltra Bot (Hintergrund-Dienst)
  - type: worker
    name: nonplusultra-bot
    env: python
    buildCommand: "pip install -r requirements.txt"
    startCommand: "python main.py" # Wir m端ssen Redis hier nicht mehr starten
    envVars:
      - key: PYTHON_VERSION
        value: 3.12.1
      - fromGroup: nonplusultra-secrets
      - key: REDIS_URL # Dies wird automatisch vom Redis-Dienst unten bereitgestellt
        fromService:
          type: redis
          name: bot-redis
          property: connectionString

  # Dienst 2: Eine dedizierte Redis-Instanz f端r die Hot Watchlist
  - type: redis
    name: bot-redis
    plan: free # Nutze den kostenlosen Redis-Plan f端r den Anfang
    maxmemoryPolicy: allkeys-lfu

# Umgebungsvariablen-Gruppe f端r alle Dienste
envVarGroups:
  - name: nonplusultra-secrets
    envVars:
      - key: QUICKNODE_RPC_URL
        sync: false
      - key: QUICKNODE_WSS_URL # Wird nicht mehr verwendet, aber wir behalten es vorerst
        sync: false
      - key: TELEGRAM_BOT_TOKEN
        sync: false
      - key: TELEGRAM_CHAT_ID
        sync: false
      - key: GOOGLE_CLOUD_PROJECT
        sync: false
      - key: UPSTASH_REDIS_URL
        sync: false
      - key: GOOGLE_APPLICATION_CREDENTIALS_JSON
        sync: false